<apex:page controller="API_MACD_ReviewQuoteController" action="{!handleQuoteReview}" sidebar="false" standardStylesheets="false" showHeader="false">
    <style>
        .scrollToTop{ padding:10px; text-align:center; font-weight: bold; color: #444; text-decoration: none; position:fixed; top:80%; right:30px; display:none; .background: url(url('!$Resource.scrollTop') no-repeat center;) no-repeat 0px 20px; width:72px; height:106px; z-index: 9999; }    
         .scrollToTop:hover{
            text-decoration:none;
        }
        
        .tabbed_menu{
            margin-top: 0;
        }
        #reviewQuote input[type="radio"] {
            width: 15px;
        }
        input.btn {
            margin: 0 10px;
            padding: 7px 20px !important;
        }
        #sitesTable thead {
            background-color: white;
        }
        #customerDetailsTable td,
        #pricingSmryTable td {
            border: 0px;
        }
        #pricingSmryTable td {
            padding: 0;
            margin: 0;
        }
        .pbSubsection table {
            width: 100%;
        }
        .removePop .modal-body table td {
            width: 400px;
            clear: both;
            float: left;
            display: table-header-group;
        }
        .removePop .modal-body table td input {
            margin-right: 10px;
        }
        .removePop .modal-body table td label {
            font-size: 16px;
            text-align: left;
            margin-left: 25px !important;
        }
        boldText {
            font-weight: bold;
        }
        .txtColSty{color:#EF6F00;}
        .btn:hover{
            background:rgb(5, 111, 171) !important;
            color:#fff !important;
        }        
    </style>
    
    <div class="row">
        <div class="col-xs-12 col-md-12 p0" style=" margin-top: 40px;">
            <h3 style="font-size: 28px !important;">Review Pricing</h3>
        </div>
    </div>
    <apex:form id="revewFormId">
        <apex:pageMessages />
        <apex:outputPanel id="custSiteId">
            <div id="main" class="row p-t-20">
                <apex:outputPanel id="dealSubmit" rendered="{!isSuccess && NOT(dealCancel) && !(quoteObj.Apttus_Proposal__Approval_Stage__c = 'Deal Reg Denied')&&!(quoteObj.Apttus_Proposal__Approval_Stage__c = 'TSC Review Requested')}">
                    <label class="greenText">Your quote has been submitted.</label>
                </apex:outputPanel>
                <apex:outputPanel id="TSC_Review" rendered="{!(quoteObj.Apttus_Proposal__Approval_Stage__c = 'TSC Review Requested')}">
                    <label class="redText">Your deal is under TSC Review</label>
                </apex:outputPanel>
                <apex:outputPanel id="dealDenied" rendered="{!(quoteObj.Apttus_Proposal__Approval_Stage__c = 'TSC Review Denied')}">
                    <label class="redText">Your deal has been declined, please reconfigure and resubmit the deal</label>
                </apex:outputPanel>
                <apex:outputPanel id="dealCancel" rendered="{!dealCancel}">
                    <label class="greenText">Your deal has been cancelled.</label>
                </apex:outputPanel>
             
                <div class="row m0">
                    <div class="col-xs-12 col-md-12 p0">
                        <div class="row p0" style="margin:10px 0 40px;">
                            <div class="col-xs-3 p0">
                                <label style="margin-right: 10px !important;">
                                    <apex:outputText id="opt1" value="Quote Name" />
                                </label>
                                <apex:outputText id="opt2" value="{!quoteObj.Apttus_Proposal__Proposal_Name__c}" />
                            </div>
                            <div class="col-xs-3 p0">
                                <label style="margin-right: 10px !important;">
                                    <apex:outputText id="opt3" value="Quote ID" />
                                </label>
                                <apex:outputText id="opt4" value="{!quoteObj.Name}" />
                            </div>
                        </div>
                    </div>
                </div>
                <apex:outputPanel rendered="{!quoteObj.Apttus_Proposal__Approval_Stage__c == 'Deal Reg Denied'}">
                    <label style="color:red;">Your deal has been declined. You can modify your order and resubmit.</label>
                </apex:outputPanel>
                <apex:outputPanel id="sitelistPanel" styleClass="m-t-20"><div style="position:relative;"> 
                    <table id="sitesTable" class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Site Name</th>
                                <th>Site Address</th>
                                <th>Actions</th>
                                <th>{!$Label.Monthly}</th>
                            </tr>
                        </thead>
                        <tbody>
                            <apex:repeat value="{!custSiteList}" var="site">
                                <tr>
                                    <td>{!site.Site_Name__c}</td>
                                    <td>{!site.Address_Line__c}, {!site.City__c},{!site.State__c}, {!site.Zip_Code__c}</td>
                                    <td class="blueText">
                                        <apex:commandLink value="{!$Label.Reconfigure}" status="loading" action="{!checkReconfigure}" style="color: #428bca !important;" rerender="reConfigurePopup" oncomplete="openReConfPop();" rendered="{!(!isSuccess)}">
                                            <apex:param value="{!site.id}" assignTo="{!siteConfigureId}" name="pNo" />
                                        </apex:commandLink>
                                        <apex:outputText id="opt5" value=" | "/>
                                        <apex:outputpanel rendered="{!NOT(mapCustSiteWithCustQuote[site.id].Hub__c||isSuccess)}">
                                            <apex:commandLink value="{!$Label.Remove}" status="loading" action="{!checkSite}" reRender="sitelistPanel,price,btnSec,AVPNPopup,RemovePopup,tstpopup" style="color: #428bca !important;" rendered="{!(NOT(site.Hub__c) && NOT(isSuccess) &&(custSiteList.size > 1 && quoteObj.Product__r.productcode!='ASES'))}" oncomplete="registerListeners();">
                                                <apex:param value="{!site.id}" assignTo="{!siteRemoveId}" name="pNo" />
                                            </apex:commandLink>
                                            <apex:commandLink value="{!$Label.Remove}" status="loading" action="{!checkSite}" reRender="sitelistPanel,price,btnSec,tstpopup,RemovePopup,ExtPopup" style="color: #428bca !important;" rendered="{!(NOT(site.Hub__c) && NOT(isSuccess) && ((((quoteObj.Product__r.productcode=='AVPN')||(quoteObj.Product__r.productcode=='AMIS') || (quoteObj.Product__r.productcode=='AIA')) && custSiteList.size == 1) || (quoteObj.Product__r.productcode=='ASES')))}" oncomplete="openRemovePop();">
                                                <apex:param value="{!site.id}" assignTo="{!siteRemoveId}" name="pNo" />
                                            </apex:commandLink>
                                        </apex:outputpanel>
                                    </td>
                                    <td>
                                        <apex:outputText id="opt6" value="${0, number, ###,###,##0.00}">
                                            <apex:param value="{!mapSiteTotalPrice[site.id]}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                            </apex:repeat>
                        </tbody>
                    </table>
                    </div>
                </apex:outputPanel>
                <apex:outputPanel id="price">
                    <div class="col-xs-12 p0 m-t-20">
                        <div style="width:600px;" class="pull-right">
                            <label class="f-s-xl"><b>Pricing Summary</b>
                            </label>
                            <table id="pricingSmryTable" class="table">
                                <tr>
                                    <td>
                                        <label class="f-s-larger"><b>One-Time Charge Grand Total</b>
                                        </label>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td><apex:outputText id="opt7" value="{!IF(quoteObj.Product__r.ProductCode == 'AIA','CPE Charge','Installation')}" /></td>
                                    <td class="text-right">
                                        <apex:outputText id="opt8" value="${0, number, ###,###,##0.00}">
                                            <apex:param value="{!oneTimeInstallationCharges}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Site Total</td>
                                    <td class="text-right">
                                        <!--         <label>{!$Label.Currency} {!oneTimeTotal}</label>-->
                                        <apex:outputText id="opt9" value="${0, number, ###,###,##0.00}">
                                            <apex:param value="{!oneTimeTotal}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <br/>
                                    </td>
                                    <td class="text-right">
                                        <br/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <label class="f-s-larger"><b>Grand Total</b>
                                        </label>
                                    </td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>Site Total</td>
                                    <td class="text-right">
                                        <!--    <label>{!$Label.Currency} {!monthlyInstallationCharges}</label> -->
                                        <apex:outputText id="opt10" value="${0, number, ###,###,##0.00}">
                                            <apex:param value="{!monthlyInstallationCharges}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="txtColSty">Additional Discount</td>
                                    <td class="text-right txtColSty">
                                        <apex:outputText id="opt11" value="- ${0, number, ###,###,##0.00}">
                                            <apex:param value="{!spDiscount}" />
                                        </apex:outputText>
                                    </td>
                                </tr>
                                  <tr>
                                    <td class="txtColSty">
                                    <!--id="AddDiscount"-->
                                    <apex:outputPanel rendered="{!specialPriceFlag =false && dealRegDiscount!= null && dealRegDiscount> 0 && ((requestSpclPricingFlag=true && quoteObj.Apttus_Proposal__Approval_Stage__c ='Draft') ||(requestSpclPricingFlag = true && (quoteObj.Apttus_Proposal__Approval_Stage__c = $Label.Quote_Deal_Approved || quoteObj.Apttus_Proposal__Approval_Stage__c = 'Special Pricing Denied' || quoteObj.Apttus_Proposal__Approval_Stage__c = 'Bulk Service Availability Completed')))}">
                                        Deal Reg Discount
                                    </apex:outputPanel>
                                    <!--id="SpecialDiscount"-->
                                    <apex:outputPanel rendered="{!specialPriceFlag =true && TotalSpecialPrice!= null && TotalSpecialPrice> 0 && quoteObj.Apttus_Proposal__Approval_Stage__c = $Label.Quote_Special_Pricing_Approved}">
                                        Special Pricing Discount
                                    </apex:outputPanel>
                                </td>
                                <td class="text-right txtColSty">
                                    <!--id="AddDiscount"-->
                                    <apex:outputPanel rendered="{!specialPriceFlag =false && dealRegDiscount!= null && dealRegDiscount> 0 && ((requestSpclPricingFlag=true && quoteObj.Apttus_Proposal__Approval_Stage__c ='Draft') ||(requestSpclPricingFlag = true && (quoteObj.Apttus_Proposal__Approval_Stage__c = $Label.Quote_Deal_Approved || quoteObj.Apttus_Proposal__Approval_Stage__c = 'Special Pricing Denied' || quoteObj.Apttus_Proposal__Approval_Stage__c = 'Bulk Service Availability Completed')))}">
                                        <apex:outputText id="opt12" value="- ${0, number, ###,###,##0.00}">
                                            <apex:param value="{!dealRegDiscount}" />
                                        </apex:outputText> 
                                    </apex:outputPanel>
                                    <!--id="SpecialDiscount"-->
                                    <apex:outputPanel rendered="{!specialPriceFlag =true && TotalSpecialPrice!= null && TotalSpecialPrice> 0 && quoteObj.Apttus_Proposal__Approval_Stage__c = $Label.Quote_Special_Pricing_Approved}">
                                         <apex:outputText id="opt13" value="- ${0, number, ###,###,##0.00}">
                                             <apex:param value="{!TotalSpecialPrice}" />
                                         </apex:outputText> 
                                    </apex:outputPanel>
                                </td>
                                
                                    <!-- Radhika : Add Special Pricing Discount End -->
                                </tr>  
                                <tr class="blueText f-s-larger" style="border-top-style: dashed;">
                                    <td><strong>Total</strong>
                                    </td>
                                    <td class="text-right">
                                        <!--    <label><strong>{!$Label.Currency} {!monthlyTotal} /mo</strong>
                                        </label> -->
                                        <strong>
                                        <apex:outputText id="opt14" value="${0, number, ###,###,##0.00} /mo">
                                            <apex:param value="{!discountedlistPrice}" />
                                        </apex:outputText>      
                                        </strong> 
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                       <p class="fine-print" style="margin:0; font-size:13px;">All prices shown are pre-tax.</p> 
                                    </td>
                                </tr>

                            </table>
                        </div>
                    </div>
                </apex:outputPanel>
            </div>
            <div style="margin-left: 115%;margin-left;margin-top: -82%;">
                    <a href="#" class="scrollToTop arrowImageDim"> <apex:image value="{!($Resource.TopArrow)}" styleClass="arrowImageDim"/></a>
            </div>
            <apex:outputPanel id="btnSec" styleClass="col-xs-12 p0 m-t-20">
                <div class="btn-group pull-right" style="clear:both;">
                    <!-- Please leave the styles on the below two buttons. Thanks, Arif -->
                    <apex:commandButton styleclass="btn btn-primary" action="{!SubmitDeal}" status="loading" value="{!$Label.SubmitAddendum}" html-data-toggle="modal" disabled="{!(IF(custSiteList.size==0,true,false))}" reRender="btnSec,sitelistPanel,price,custSiteId,dealSubmit,dealCancel" rendered="{!!isSuccess}" style="margin-right: 0; border-top-right-radius: 0 !important; border-bottom-right-radius: 0 !important;font-family:omnes_att_iimedium !important;font-size:16px !important;color: #feffff !important;text-align: left !impoartant;height:40px !important;" />
                    <apex:commandButton styleClass="btn btn-default custDropReviewQTrig dropdown-toggle m0" html-data-toggle="dropdown" value="▼" style="width:56px !important;margin-left: 0;border-bottom-left-radius: 0 !important;border-top-left-radius: 0 !important;background: #fff !important;color: #428bca !important;height:40px;" disabled="{!(IF(custSiteList.size==0,true,false))}" rendered="{!!isSuccess}">
                        <span class="sr-only">Toggle Dropdown</span>
                    </apex:commandButton>
                    <ul class="dropdown-menu custDropReviewQ" role="menu" style="width:95%;margin-right: 10px;margin-top: 0px;height: auto !important;">
                        <li>
                            <apex:commandLink value="{!$Label.RequestSpecialPricing}" action="{!SpecialPricing}" style="font-family:omnes_att_iimedium !important;font-size:16px !important;color: #44c8f5 !important;text-align: left !impoartant;margin-top: 10px;" rendered="{!requestSpclPricingFlag}" />
                         </li>
                        <li>
                            <apex:commandLink value="Save & Exit" action="{!SaveandExit}" style="font-family:omnes_att_iimedium !important;font-size:16px !important;color: #44c8f5 !important;text-align: left !impoartant;margin-top: 10px;" status="loading"/>
                        </li>
                       
                        <li>
                            <apex:outputLink id="olink" value=""  onclick="window.open('/apex/macd_quoteInexcelformat?quoteId={!quoteObj.id}'); return false" target="_parent" style="font-family:omnes_att_iimedium !important;font-size:16px !important;color: #44c8f5 !important;text-align: left !impoartant;margin-top: 10px;margin-bottom: 10px;" >Export</apex:outputLink>
                        </li>
                    </ul>
                    <apex:commandButton styleclass="btn btn-primary m-r-10 m pull-right" action="{!checkReconfigure}" value="{!$Label.Reconfigure}" rendered="{!isSuccess && (quoteObj.Apttus_Proposal__Approval_Stage__c = 'Deal Reg Denied')}" reRender="btnSec,custSiteId,dealSubmit,dealCancel" status="loading"/>
                </div>
            </apex:outputPanel>
            <div id="submitSuccess" class="modal" role="dialog" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header br-0">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="font-weight: bold; font-size: 14px !important; color: #333; opacity: 1;">close x</button>
                        </div>
                    </div>
                </div>
            </div>
        </apex:outputPanel>
        <!-- Pop Up Window-->
        <apex:outputPanel id="tstpopup">
            
            <div class="modal fade removePop" id="RemovePopup" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-keyboard="false" data-backdrop="static">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <apex:outputPanel styleClass="" id="panelASESPointToPoint" layout="block" rendered="{!(quoteObj.Ethernet_Configuration__c=='Ethernet Private Line (Point-to-Point)')&&(displayPopUp==True)&&(quoteObj.Product__r.productcode=='ASES')}">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>
                                <h3 class="modal-title" id="myModalLabelR1">Remove</h3>
                            </div>
                            <div class="modal-body">
                                <p>
                                    By removing this site you will not have the minimum sites required for this configuration. If you want to proceed,choose one of the options below and click <b>Continue.</b>
                                </p>
                                <apex:selectRadio value="{!selectedRemoveValue}" styleClass="removeSiteBtnTrigger" id="ptoPSelectOption" onclick="changeValue(this,'{!$Component.RadioButtonValue}');" >
                                    <apex:selectOption itemValue="Remove this Site and Add a New Site" itemlabel="Remove this Site and Add a New Site" />
                                    <apex:selectOption itemValue="Delete this quote and return to Dashboard" itemlabel="Delete this quote and return to Dashboard" />
                                </apex:selectRadio>
                            </div>
                            <div class="modal-footer">
                                <apex:commandButton styleclass="btn btn-primary removeSiteBtn" value="Continue" action="{!statusUpdate}" rerender="tstpopup,sitelistPanel,price,btnSec" id="btnContinueASESPToP"/>
                                <apex:commandButton styleclass="btn btn-default" value="Cancel" action="{!closePopup}" rerender="tstpopup" html-data-dismiss="modal" id="btnCancelASESPToP"/>
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel styleClass="" id="panelASESHubSpoke3" layout="block" rendered="{!(quoteObj.Ethernet_Configuration__c=='Ethernet Virtual Private Line (Hub-and-Spoke)')&&(displayPopUp==True)&&(custSiteList.size>3)&&(quoteObj.Product__r.productcode=='ASES')}">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>
                                <h4 class="modal-title" id="myModalLabelR2">Remove</h4>
                            </div>
                            <div class="modal-body">
                                <p>
                                    By removing this site you will not have the minimum sites required for this configuration. If you want to proceed,choose one of the options below and click <b>Continue.</b>
                                </p>
                                <apex:selectRadio styleclass="removeQuoteModalSelect" value="{!selectedRemoveValue}" id="nonAseSelectOption" onclick="changeValue(this,'{!$Component.RadioButtonValue}');" >
                                    <apex:selectOption itemValue="Remove this Site and Add a New Site" itemlabel="Remove this Site and Add a New Site" html-name="removeQuoteModalRadioSelect" html-class="removeQuoteModalRadioSelect" />
                                    <apex:selectOption itemValue="Remove the Site" itemlabel="Remove this Site" html-name="removeQuoteModalRadioSelect"  html-class="removeQuoteModalRadioSelect" />
                                    <apex:selectOption itemValue="Delete this quote and return to Dashboard" itemlabel="Delete this quote and return to Dashboard" html-name="removeQuoteModalRadioSelect"  html-class="removeQuoteModalRadioSelect" />
                                </apex:selectRadio>
                            </div>
                            <div class="modal-footer">
                            <!-- @Defect 100528; Adding new attribute to continue command button 'html-data-dismiss="modal"' -->
                                <apex:commandButton styleclass="btn btn-primary disabled removeQuoteModalContinue" value="Continue" action="{!statusUpdate}" rerender="reConfigurePopup,sitelistPanel,price,btnSec,tstpopup" id="btnContinueASESHubSpoke3" html-data-dismiss="modal" status="loading"/>
                                <apex:commandButton styleclass="btn btn-default" value="Cancel" action="{!closePopup}" rerender="reConfigurePopup" html-data-dismiss="modal" id="btnCancelASESHubSpoke3" />
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel id="panelASESHubSpoke4" styleClass="" layout="block" rendered="{!(quoteObj.Ethernet_Configuration__c=='Ethernet Virtual Private Line (Hub-and-Spoke)')&&(displayPopUp==True)&&(custSiteList.size==3)&&(quoteObj.Product__r.productcode=='ASES')}">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>
                                <h4 class="modal-title" id="myModalLabelR3">Remove</h4>
                            </div>
                            <div class="modal-body">
                                <p>By removing this site you will not have the minimum sites required for this configuration. If you want to proceed,choose one of the options below and click <b>Continue.</b>
                                </p>
                                <apex:selectRadio value="{!selectedRemoveValue}" id="aseSelectOption" onclick="changeValue(this,'{!$Component.RadioButtonValue}');" >
                                    <apex:selectOption itemValue="Remove this Site and Add a New Site" itemlabel="Remove this Site and Add a New Site" />
                                    <apex:selectOption itemValue="Change the network Product to Point-to-Point" itemlabel="Change the network Product to Point-to-Point" />
                                    <apex:selectOption itemValue="Delete this quote and return to Dashboard" itemlabel="Delete this quote and return to Dashboard" />
                                </apex:selectRadio>
                            </div>
                            <div class="modal-footer">
                                <apex:commandButton styleclass="btn btn-primary" value="Continue" action="{!statusUpdate}" rerender="reConfigurePopup,sitelistPanel,price,btnSec" id="btnContinueASESHubSpoke4" />
                                <apex:commandButton styleclass="btn btn-default" value="Cancel" action="{!closePopup}" rerender="reConfigurePopup" html-data-dismiss="modal" id="btnCancelASESHubSpoke4" />
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel id="AVPNPopup" styleClass="" layout="block" rendered="{!((quoteObj.Product__r.productcode=='AVPN')||(quoteObj.Product__r.productcode=='AMIS') || (quoteObj.Product__r.productcode=='AIA'))&&(displayPopUp==true)}">
                            <div class="modal-header">
                                <button type="button" class="close" onclick="registerListeners();" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>
                                <h4 class="modal-title" id="myModalLabelR3">Remove</h4>
                            </div>
                            <div class="modal-body">
                                <p>By removing this site you will not have the minimum sites required for this configuration. If you click <b>Continue</b> your Quote will be deleted
                                </p>
                            </div>
                            <div class="modal-footer">
                                <apex:commandButton styleclass="btn btn-primary" value="Continue" action="{!AVPNremove}" rerender="reConfigurePopup,sitelistPanel,price,btnSec, tstpopup" id="btnAVPNPopupContinue"/>
                                <apex:commandButton styleclass="btn btn-default" onclick="registerListeners();" value="Cancel"  rerender="reConfigurePopup" html-data-dismiss="modal" id="btnAVPNPopupCancel" oncomplete="registerListeners();"/>
                            </div>
                        </apex:outputPanel>

                    </div>
                </div>
                <!-- /.modal-dialog -->
            </div>
            <!-- /.modal -->
            <apex:inputHidden value="{!selectedRemoveValue}" id="RadioButtonValue" />
        </apex:outputPanel>
        <!--End of Pop Up Window-->
        <div class="modal fade reconfigure">
            <div class="modal-dialog">
                <div class="modal-content">
                    <apex:outputPanel id="reConfigurePopup">
                        <apex:outputPanel styleClass="" layout="block" rendered="{!displayPopUp}">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>
                                <h4 class="modal-title" id="myModalLabel">Change Product Network Configuration</h4>
                            </div>
                            <div class="modal-body">
                                <p>You can change your network configuration to point-to-point, any-to-any or hub-and-spoke.
                                </p>
                                <br />
                                <p>
                                    If you choose to proceed, this step will delete all Ethernet Virtual Connections you have created and you will have to reconfigure your sites.
                                </p>
                                <br />
                                <p>
                                    Clicking <b>Continue</b> will navigate you to the Change Network Configuration page. Do you want to continue?
                                </p>
                            </div>
                            <div class="modal-footer">
                                <apex:commandButton styleClass="btn btn-primary" value="Continue" action="{!Reconfigure}" rerender="reConfigurePopup,sitelistPanel,price,btnSec" />
                                <apex:commandButton styleClass="btn btn-default" html-data-dismiss="modal" value="Cancel" action="{!closePopup}" rerender="reConfigurePopup" />
                            </div>
                        </apex:outputPanel>
                    </apex:outputPanel>
                </div>
            </div>
            <!-- /.modal-dialog -->
        </div>
        <div class="modal fade addAddress">
            <div class="modal-dialog">
                <div class="modal-content">
                    <apex:outputPanel id="addaddresspopup">
                        <apex:outputPanel styleClass="" layout="block" rendered="{!(AddAdress)&&(quoteObj.Product__r.productcode=='ASES')&&(quoteObj.Ethernet_Configuration__c=='Ethernet Virtual Private Line (Hub-and-Spoke)')}">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>
                                <h4 class="modal-title" id="myModalLabelR2"></h4>
                            </div>
                            <div class="modal-body">
                                <p>
                                    You can change your network configuration to point-to-point, any-to-any or hub-and-spoke.
                                </p>
                                <br />
                                <p>
                                    If you choose to proceed, this step will delete all Ethernet Virtual Connections you have created and you will have to reconfigure your sites.
                                </p>
                                <br />
                                <p>
                                    Clicking <b>Continue</b> will navigate you to the Change Network Configuration page. Do you want to continue?
                                </p>
                            </div>
                            <div class="modal-footer">
                                <apex:commandButton styleclass="btn btn-primary" value="Continue" action="{!GotoAddAddressPage}" rerender="reConfigurePopup,sitelistPanel,price,btnSec" />
                                <apex:commandButton styleclass="btn btn-default" value="Cancel" action="{!closePopup}" rerender="reConfigurePopup" html-data-dismiss="modal" />
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel styleClass="" layout="block" rendered="{!(AddAdress)&&(quoteObj.Product__r.productcode=='ASES')&&(quoteObj.Ethernet_Configuration__c=='Ethernet Private Line (Point-to-Point)')}">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>
                                <h4 class="modal-title" id="myModalLabelR2"></h4>
                            </div>
                            <div class="modal-body">
                                <p>If you add another Site, your configuration will change to Hub and Spoke
                                </p>
                                <p>
                                    Clicking <b>Continue</b> will navigate you to the Add Address page.Do you want to continue ?
                                </p>
                            </div>
                            <div class="modal-footer">
                                <apex:commandButton styleclass="btn btn-primary" value="Continue" action="{!GotoAddAddressPage}" rerender="reConfigurePopup,sitelistPanel,price,btnSec" />
                                <apex:commandButton styleclass="btn btn-default" value="Cancel" action="{!closePopup}" rerender="reConfigurePopup" html-data-dismiss="modal" />
                            </div>
                        </apex:outputPanel>
                    </apex:outputPanel>
                </div>
            </div>
            <!-- /.modal-dialog -->
        </div>

        <div class="modal waitingSearchDiv" id="remotingScroll" style="display:none; background-color: #fbfbfb; opacity:0.65; position:fixed; width:100%; height:100%; top:0px; left:0px; z-index:1000;">
            <div class="waitingHolder" style="top: 40%; left: 50%; position: fixed;">
                <img class="waitingImage" src="{!$Resource.LoadingImage}" title="Please Wait" />
            </div>
        </div>
        <!-- /.modal -->
        <!--End of Pop Up Window----------------------------------------------------------->
        <!--End of Pop Up Window----------------------------------------------------------->
        <apex:actionFunction id="af1" name="handleReviewQuotePage" action="{!handleQuoteReview}" reRender="revewFormId" status="loading" oncomplete="collapseMe();">
            <apex:param name="quoteId" value="" />
        </apex:actionFunction>
        <apex:actionFunction id="dupRedirect" name="dupRedirect" action="{!Reconfigure}" status="loading">

        </apex:actionFunction>
        <script>
            function changeValue(input, textid) {
                document.getElementById(textid).value = input.value;
            }
            function openRemovePop() {
                $('.removePop').modal();
                toggleContinueButton();
                disableRemoveSiteBtn();
                $('.removeSiteBtnTrigger input').on('change', function () {
                    disableRemoveSiteBtn();
                });
            }

            function disableRemoveSiteBtn() {
                if ($('.removeSiteBtnTrigger input:checked').length > 0) {
                    $('.removeSiteBtn').removeClass('disabled');
                } else {
                    $('.removeSiteBtn').addClass('disabled');
                }
            }

            function openReConfPop() {
                $('.reconfigure').modal();
            }

            function openAddAddressPop() {
                $('.addAddress').modal();
            }
        </script>
    </apex:form>
    <script type="text/javascript">
        function toggleContinueButton() {
            $(".removeQuoteModalRadioSelect").on("change", function () {
                if ($(this).is(":checked")) {
                    $(".removeQuoteModalContinue").removeClass("disabled");
                } else {
                    $(".removeQuoteModalContinue").addClass("disabled");
                }
            });
        }

        function handleReConfigureSite() {
            if (generatedQuoteId != null && generatedQuoteId != '') {
                handleReviewQuoteCallBack(generatedQuoteId);
                $("a[data-name='configSites']").attr('data-toggle', 'tab').attr('href', '#configSites').parent('li').removeClass('disabled').children('a').trigger("click");
                $("a[data-name='reviewQuote']").removeAttr('data-toggle href').parent('li').addClass("disabled");
            }
        }
    
        $(document).ready(function () {
            //mode is global variable in Parent file
            if(mode == 'reviewquote' || mode == 'cartmode'){
                reDirectToConfigure = {!reDirectToConfigure};
                if(reDirectToConfigure){
                    window.location.href = '{!redirectToConfigPage}';
                }            
            }
            toggleContinueButton();
            $(window).scroll(function(){
                if ($(this).scrollTop() > 100) {
                    $('.scrollToTop').fadeIn();
                } else {
                    $('.scrollToTop').fadeOut();
                }
            });
            
            $('.scrollToTop').click(function(){
                $('html, body').animate({scrollTop : 0},500);
                return false;
            });
            
        });
    
        function onReviewShowUp() {
            registerListeners();
        }

        function registerListeners() {
            $('.custDropReviewQTrig').on('click', function () {
                $('.custDropReviewQ').dropdown('toggle');
            });
        }

        function completePricing(cartId) {
            Visualforce.remoting.timeout = 120000; // Set timeout at page level
            if (cartId != null) {
                $("[Id$=remotingScroll]").show();
                Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.API_MACD_ReviewQuoteController.IsPricingUpdateRequired}', cartId,
                    function (result, event) {
                        if (event.status) {
                            if (result === true || result == 'true') {
                                completePricing(cartId);
                            } else {
                                dupRedirect();
                                $("[Id$=remotingScroll]").hide();
                            }
                        } else if (event.type === 'exception') {
                            $("[Id$=remotingScroll]").hide();
                        } else {
                            $("[Id$=remotingScroll]").hide();
                        }
                    }, {
                        escape: true
                    }
                );
            }
            $('.main').modal('hide');
        }
    </script>
    <apex:outputPanel id="onCompletePanel" rendered="{!isCreationComplete}">
        <script type="text/javascript">
            $('.custDropReviewQTrig').on('click', function () {
                $('.custDropReviewQ').dropdown('toggle');
            });
        </script>
     </apex:outputPanel>
</apex:page>